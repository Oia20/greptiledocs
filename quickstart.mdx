---
title: 'Quickstart'
description: 'Get started with the Greptile API'
---

This guide will help you set up the Greptile API to answer hard questions about your codebase. There are only three steps, **authenticate**, **index**, and **query**. 

The base url for the API is `api.greptile.com/v2/`.

## Authenticate

You need a Greptile key and a personal access token (PAT) from GitHub to authenticate the Greptile API. 

1. **Greptile API key**

Click [here](https://app.greptile.com/api) to get your Greptile key. You will need to log in via GitHub or Microsoft. 


2. **Authenticate GitHub**

Greptile needs read-access to your GitHub to be able to index your repos. You can provision a GitHub PAT by following [this guide from GitHub](https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#creating-a-fine-grained-personal-access-token)

## Indexing

Before Greptile can search and answer questions about a repo, it must first be indexed. This can take 3-5 minutes for small repos and over an hour for big ones, but you only need to do this once Each index that Greptile generates is stored in our database. 

1. **Submit a repo for indexing**

You can use the ` POST /repository` endpoint to submit a repo indexing job. 

<CodeGroup>

  ```bash cURL
  curl -X POST \
    https://api.example.com/repository \
    -H 'Content-Type: application/json' \
    -d '{
      "remote": "github",
      "repository": "vkameswaran/test"
  }'
  ```

  ```javascript node
  const fetch = require('node-fetch');

  const requestBody = {
      remote: "github",
      repository: "vkameswaran/test"
  };

  fetch('https://api.example.com/repository', {
      method: 'POST',
      headers: {
          'Content-Type': 'application/json'
      },
      body: JSON.stringify(requestBody)
  })
  .then(response => response.json())
  .then(data => console.log(data))
  .catch(error => console.error('Error:', error));
  ```

  ```python python
  import requests

  url = 'https://api.example.com/repository'
  headers = {'Content-Type': 'application/json'}
  payload = {
      'remote': 'github',
      'repository': 'vkameswaran/test'
  }

  response = requests.post(url, json=payload, headers=headers)
  print(response.json())

  ```

  ```go go
  package main

  import (
    "bytes"
    "encoding/json"
    "fmt"
    "net/http"
  )

  func main() {
    url := "https://api.example.com/repository"
    data := map[string]string{
      "remote":     "github",
      "repository": "vkameswaran/test",
    }
    payload, _ := json.Marshal(data)

    req, err := http.NewRequest("POST", url, bytes.NewBuffer(payload))
    req.Header.Set("Content-Type", "application/json")

    client := &http.Client{}
    resp, err := client.Do(req)
    if err != nil {
      panic(err)
    }
    defer resp.Body.Close()

    fmt.Println("Response Status:", resp.Status)
  }

  ```
</CodeGroup>

<AccordionGroup>
    <Accordion title="Sample request body">
        ```json
        {
            "remote": "github",
            "repository": "vkameswaran/test" // formatted as owner/repository
            // note that optional fields are ommitted here, see API reference for full set of fields. 
        }
        ```
    </Accordion>

    <Accordion title="Sample response body">

        ```json
        {
            "response": "started repo processing"
        }
        ```
    </Accordion>
</AccordionGroup>


2. **Check repo indexing progress**

You can use the ` GET /repository` endpoint to submit a job and also get it's current status. 

The repository identifier should be a URL-safe encoded version of `remote:owner/repository:branch", e.g. github%3Acooldev2024%2Fmyrepo%3Amain


<CodeGroup>

  ```bash cURL
    curl -X GET \
      https://api.example.com/repository?identifier=github%3Acooldev2024%2Fmyrepo%3Amain

  ```

  ```javascript node
  const fetch = require('node-fetch');

  const identifier = encodeURIComponent("github:cooldev2024/myrepo:main");

  fetch(`https://api.example.com/repository?identifier=${identifier}`)
      .then(response => response.json())
      .then(data => console.log(data))
      .catch(error => console.error('Error:', error));

  ```

  ```python python
  import requests

  identifier = "github%3Acooldev2024%2Fmyrepo%3Amain"
  url = f"https://api.example.com/repository?identifier={identifier}"

  response = requests.get(url)
  print(response.json())


  ```

  ```go go
  package main

  import (
    "fmt"
    "net/http"
  )

  func main() {
    identifier := "github%3Acooldev2024%2Fmyrepo%3Amain"
    url := fmt.Sprintf("https://api.example.com/repository?identifier=%s", identifier)

    resp, err := http.Get(url)
    if err != nil {
      panic(err)
    }
    defer resp.Body.Close()

    fmt.Println("Response Status:", resp.Status)
  }
  ```
</CodeGroup>

The JSON response has a `status` field which should be one of the following options:

1. `submitted`: the job is in queue.
2. `cloning`: the repo is being cloned to emphemral storage to begin indexing.
3. `processing`: indexing is in in progress. This is the longest step.
4. `completed`: the repo index is ready to be queried!



## Query

Now, you can send natural language queries to Greptile. To do this, use the `POST /query` endpoint. Note that this endpoint is based on the OpenAI Chat format, so the query must be formatted as a `messages` object, which can simply have length 1. 

Here's what a sample request looks like:


<CodeGroup>

  ```bash cURL
curl -X POST \
  https://api.example.com/query \
  -H 'Content-Type: application/json' \
  -d '{
    "messages": [
      {
        "id": "some-id-1",
        "content": "What is the best fruit?",
        "role": "user"
      }
    ],
    "repositories": [
      {
        "name": "vkameswaran/test",
        "branch": "main"
      }
    ],
    "sessionId": "00wr06v8igyjck8v5ggydo7"
}'

  ```

  ```javascript node
const fetch = require('node-fetch');

const requestBody = {
    messages: [
        {
            id: "some-id-1",
            content: "What is the best fruit?",
            role: "user"
        }
    ],
    repositories: [
        {
            name: "vkameswaran/test",
            branch: "main"
        }
    ],
    sessionId: "00wr06v8igyjck8v5ggydo7"
};

fetch('https://api.example.com/query', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json'
    },
    body: JSON.stringify(requestBody)
})
.then(response => response.json())
.then(data => console.log(data))
.catch(error => console.error('Error:', error));


  ```

  ```python python
import requests

url = 'https://api.example.com/query'
headers = {'Content-Type': 'application/json'}
payload = {
    "messages": [
        {
            "id": "some-id-1",
            "content": "What is the best fruit?",
            "role": "user"
        }
    ],
    "repositories": [
        {
            "name": "vkameswaran/test",
            "branch": "main"
        }
    ],
    "sessionId": "00wr06v8igyjck8v5ggydo7"
}

response = requests.post(url, json=payload, headers=headers)
print(response.json())

  ```

  ```go go
package main

import (
	"bytes"
	"encoding/json"
	"fmt"
	"net/http"
)

func main() {
	url := "https://api.example.com/query"
	data := map[string]interface{}{
		"messages": []map[string]string{
			{
				"id":      "some-id-1",
				"content": "What is the best fruit?",
				"role":    "user",
			},
		},
		"repositories": []map[string]string{
			{
				"name":   "vkameswaran/test",
				"branch": "main"
			},
		},
		"sessionId": "00wr06v8igyjck8v5ggydo7",
	}

	payload, _ := json.Marshal(data)

	req, err := http.NewRequest("POST", url, bytes.NewBuffer(payload))
	req.Header.Set("Content-Type", "application/json")

	client := &http.Client{}
	resp, err := client.Do(req)
	if err != nil {
		panic(err)
	}
	defer resp.Body.Close()

	fmt.Println("Response Status:", resp.Status)
}


  ```
</CodeGroup>


<Accordion title="Sample response">

    ```json
    {
        "type": "status",
        "message": "Received request"
    }
    {
        "type": "status",
        "message": "Started processing request"
    }
    {
        "type": "status",
        "message": "Identifying relevant sources"
    }
    {
        "type": "sources",
        "message": [
            {
                "text": "Path: /README.md \nSummary: This code file does not contain any classes or functions. It is simply a comment providing information about the purpose of the file and a personal opinion about the best fruit.",
                "index": "65ca74eedcc77b8d1ab065e5",
                "id": "42664c872c0dc547d1466e52df19d5c2",
                "metadata": {
                    "branch": "main",
                    "filepath": "README.md",
                    "remote": "github",
                    "repository": "dmthbWVzd2FyYW4vdGVzdA"
                },
                "createdAt": "2024-02-12T19:44:01.899Z",
                "source": {},
                "dist": 0
            },
            // more sources
        ]
    }
    {
        "type": "status",
        "message": "Writing response"
    }
    {
        "type": "message",
        "message": "Based"
    }
    {
        "type": "message",
        "message": " on"
    }
    {
        "type": "message",
        "message": " the"
    }
    {
        "type": "message",
        "message": " information"
    }
    // ... chunks omitted for brevity ...
    {
        "type": "message",
        "message": " purposes"
    }
    {
        "type": "message",
        "message": "."
    }
    {
        "type": "status",
        "message": ""
    }
    ```
</Accordion>

## Summary

Here is a combined code sample:

<CodeGroup>
```javascript node
const fetch = require('node-fetch');

// Sample request body for POST /repository endpoint
const repositoryRequestBody = {
    remote: "github",
    repository: "vkameswaran/test"
};

// Sample identifier for GET /repository endpoint
const repositoryIdentifier = encodeURIComponent("github:cooldev2024/myrepo:main");

// Sample request body for POST /query endpoint
const queryRequestBody = {
    messages: [
        {
            id: "some-id-1",
            content: "What is the best fruit?",
            role: "user"
        }
    ],
    repositories: [
        {
            name: "vkameswaran/test",
            branch: "main"
        }
    ],
    sessionId: "00wr06v8igyjck8v5ggydo7"
};

// POST /repository
fetch('https://api.example.com/repository', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json'
    },
    body: JSON.stringify(repositoryRequestBody)
})
.then(response => response.json())
.then(data => {
    console.log("Response from POST /repository:", data);
    // GET /repository
    return fetch(`https://api.example.com/repository?identifier=${repositoryIdentifier}`);
})
.then(response => response.json())
.then(data => {
    console.log("Response from GET /repository:", data);
    // POST /query
    return fetch('https://api.example.com/query', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(queryRequestBody)
    });
})
.then(response => response.json())
.then(data => console.log("Response from POST /query:", data))
.catch(error => console.error('Error:', error));

```

```python python
import requests

# Sample request body for POST /repository endpoint
repository_payload = {
    'remote': 'github',
    'repository': 'vkameswaran/test'
}

# Sample identifier for GET /repository endpoint
repository_identifier = "github%3Acooldev2024%2Fmyrepo%3Amain"

# Sample request body for POST /query endpoint
query_payload = {
    "messages": [
        {
            "id": "some-id-1",
            "content": "What is the best fruit?",
            "role": "user"
        }
    ],
    "repositories": [
        {
            "name": "vkameswaran/test",
            "branch": "main"
        }
    ],
    "sessionId": "00wr06v8igyjck8v5ggydo7"
}

# POST /repository
repository_response = requests.post('https://api.example.com/repository', json=repository_payload)
print("Response from POST /repository:", repository_response.json())

# GET /repository
repository_response = requests.get(f'https://api.example.com/repository?identifier={repository_identifier}')
print("Response from GET /repository:", repository_response.json())

# POST /query
query_response = requests.post('https://api.example.com/query', json=query_payload)
print("Response from POST /query:", query_response.json())

```

```go go
package main

import (
	"bytes"
	"encoding/json"
	"fmt"
	"net/http"
)

func main() {
	// Sample request body for POST /repository endpoint
	repositoryData := map[string]string{
		"remote":     "github",
		"repository": "vkameswaran/test",
	}
	repositoryPayload, _ := json.Marshal(repositoryData)

	// Sample identifier for GET /repository endpoint
	repositoryIdentifier := "github%3Acooldev2024%2Fmyrepo%3Amain"

	// Sample request body for POST /query endpoint
	queryData := map[string]interface{}{
		"messages": []map[string]string{
			{
				"id":      "some-id-1",
				"content": "What is the best fruit?",
				"role":    "user",
			},
		},
		"repositories": []map[string]string{
			{
				"name":   "vkameswaran/test",
				"branch": "main",
			},
		},
		"sessionId": "00wr06v8igyjck8v5ggydo7",
	}
	queryPayload, _ := json.Marshal(queryData)

	// POST /repository
	repositoryReq, _ := http.NewRequest("POST", "https://api.example.com/repository", bytes.NewBuffer(repositoryPayload))
	repositoryReq.Header.Set("Content-Type", "application/json")
	repositoryClient := &http.Client{}
	repositoryResp, _ := repositoryClient.Do(repositoryReq)
	defer repositoryResp.Body.Close()
	fmt.Println("Response from POST /repository:", repositoryResp.Status)

	// GET /repository
	repositoryGetResp, _ := http.Get(fmt.Sprintf("https://api.example.com/repository?identifier=%s", repositoryIdentifier))
	defer repositoryGetResp.Body.Close()
	fmt.Println("Response from GET /repository:", repositoryGetResp.Status)

	// POST /query
	queryReq, _ := http.NewRequest("POST", "https://api.example.com/query", bytes.NewBuffer(queryPayload))
	queryReq.Header.Set("Content-Type", "application/json")
	queryClient := &http.Client{}
	queryResp, _ := queryClient.Do(queryReq)
	defer queryResp.Body.Close()
	fmt.Println("Response from POST /query:", queryResp.Status)
}

```
</CodeGroup>
If you have any questions, please reach out to us at [support@greptile.com](mailto:support@greptile.com)